import{n as d}from"./application-default-icon-a19c8ba0.js";import{g as o}from"./utils-2c87b698.js";const t={config:{name:"StatusBar",type:"library",targetVer:"1.0.0-indev.0"},init:(e,a,n)=>{if(t.data.element=new e.HTML("toolbar"),t.data.element.html(`
      <div class="outlined" data-toolbar-id="start"><span class="material-symbols-rounded">space_dashboard</span></div>
      
      <div data-toolbar-id="apps"></div>
      <div style="flex:1;"></div>
      <div class="outlined" data-toolbar-id="plugins"><span class="material-symbols-rounded">expand_less</span></div>
      <div class="outlined" data-toolbar-id="controls">
        <span class="material-symbols-rounded battery">battery_2_bar</span>
        <span class="material-symbols-rounded signal">signal_cellular_4_bar</span>
      </div>
      <div class="outlined" data-toolbar-id="calendar"></div>
      
    `),setInterval(()=>{o().then(l=>{t.data.element.qs('div[data-toolbar-id="calendar"]')?.text(l)}).catch(l=>console.error)},1e3),"getBattery"in navigator)navigator.getBattery().then(l=>{t.data.updateBatteryIcon(l),l.addEventListener("levelchange",()=>{t.data.updateBatteryIcon(l)}),l.addEventListener("chargingchange",()=>{t.data.updateBatteryIcon(l)})});else{const l=document.querySelector('div[data-toolbar-id="controls"] > .battery');l!=null&&(l.innerHTML="battery_unknown")}async function i(l){fetch(`${a.config.SERVER}/bare/`).then(()=>{const r=performance.now()-l;t.data.updateIcon(r)}).catch(()=>{document.querySelector('div[data-toolbar-id="controls"] > .signal').innerHTML="signal_cellular_connected_no_internet_4_bar"})}setInterval(()=>i(performance.now()),1e4),document.addEventListener("app_opened",l=>{new e.HTML("app").appendMany(new e.HTML("img").attr({alt:`${l.detail.proc.config.name} icon`,"data-id":l.detail.token,src:l.detail.proc.config.icon??d}).on("click",()=>{l.detail.win.focus(),l.detail.win.toggleMin()})).appendTo(t.data.element.qs('div[data-toolbar-id="apps"]')?.elm)}),document.addEventListener("app_closed",l=>{t.data.element.qs('div[data-toolbar-id="apps"]')?.qs(`img[data-id="${l.detail.token}"]`)?.elm.parentElement?.remove()})},data:{updateBatteryIcon(e){let a="";e.charging===!0?e.level===1?a="battery_charging_full":e.level>=.9?a="battery_charging_90":e.level>=.8?a="battery_charging_80":e.level>=.6?a="battery_charging_60":e.level>=.5?a="battery_charging_50":e.level>=.3?a="battery_charging_30":e.level>=0&&(a="battery_charging_20"):e.level===1?a="battery_full":e.level>=.6?a="battery_6_bar":e.level>=.5?a="battery_5_bar":e.level>=.4?a="battery_4_bar":e.level>=.3?a="battery_3_bar":e.level>=.2?a="battery_2_bar":e.level>=.1?a="battery_1_bar":e.level>=0&&(a="battery_0_bar");const n=document.querySelector('div[data-toolbar-id="controls"] > .battery');n!=null&&(n.innerHTML=a)},updateIcon(e){let a="";e>=200&&e<400?a="signal_cellular_1_bar":e>=400&&e<600?a="signal_cellular_2_bar":e>=600&&e<800?a="signal_cellular_3_bar":e>=800?a="signal_cellular_4_bar":a="signal_cellular_0_bar",document.querySelector('div[data-toolbar-id="controls"] > .signal').innerHTML=a}}};export{t as default};
